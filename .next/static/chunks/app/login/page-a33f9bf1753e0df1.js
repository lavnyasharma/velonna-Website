(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2626],{72770:function(e){"use strict";e.exports=next},12766:function(e,t,r){Promise.resolve().then(r.bind(r,43918))},43918:function(e,t,r){"use strict";r.r(t);var s=r(57437),a=r(2265),n=r(10298),o=r(61396),c=r.n(o),l=r(56230),i=r(54829),u=r(24033),d=r(5925),m=r(40265);t.default=()=>{let[e,t]=(0,a.useState)(!1),r=(0,u.useRouter)(),{is_auth:o}=(0,m.a)();(0,a.useEffect)(()=>{},[o]),o&&r.push("/");let h=async(e,t)=>{let{resetForm:s}=t;try{let t=await i.Z.post("https://api.velonna.co/login/",{username:e.username,password:e.password},{headers:{accept:"application/json","Content-Type":"application/json","X-CSRFToken":"ULx41so9FZF04FaONS6tTQfcAGaGBG9FHESSxWUcHDN14DF5JFAyIRXd7bggbrWJ"}});if(200===t.status){let{access:s,refresh:a}=t.data;localStorage.setItem("accessToken",s),localStorage.setItem("refreshToken",a),localStorage.setItem("username",e.username),d.default.success("Login successful!"),r.push("/")}}catch(e){console.error("Login error:",e),d.default.error("Login failed. Please check your credentials.")}s()};return(0,s.jsx)("div",{className:"nc-PageSignUp ",children:(0,s.jsxs)("div",{className:"custom-container mb-24 lg:mb-32",children:[(0,s.jsx)("h2",{className:"my-20 flex items-center text-3xl leading-[115%] md:text-5xl md:leading-[115%] font-semibold text-neutral-900 dark:text-neutral-100 justify-center",children:"Login"}),(0,s.jsxs)("div",{className:"max-w-md mx-auto space-y-6",children:[(0,s.jsx)(l.J9,{initialValues:{username:"",password:""},validate:e=>{let t={};return e.username||(t.username="Required"),e.password||(t.password="Required"),t},onSubmit:h,children:r=>{let{isSubmitting:a,errors:o}=r;return(0,s.jsxs)(l.l0,{className:"grid grid-cols-1 gap-6",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"text-neutral-800 dark:text-neutral-200",htmlFor:"username",children:"Username"}),(0,s.jsx)(l.gN,{name:"username",children:e=>{let{field:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{...t,className:"shadow appearance-none border rounded-2xl w-full h-11 px-4 py-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ".concat(o.username?"border-red-500":""),type:"text",placeholder:"Username"}),(0,s.jsx)(l.Bc,{className:"text-red-500 text-xs italic",name:"username",component:"div"})]})}})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("span",{className:"flex justify-between items-center text-neutral-800 dark:text-neutral-200",children:["Password",(0,s.jsx)(c(),{href:"/forgot-pass",className:"text-sm text-green-600",children:"Forgot password?"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.gN,{name:"password",children:t=>{let{field:r}=t;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("input",{...r,className:"shadow appearance-none border rounded-2xl h-11 px-4 py-3 w-full text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline ".concat(o.password?"border-red-500":""),type:e?"text":"password",placeholder:"Password"})})}}),(0,s.jsx)("span",{className:"absolute right-0 top-0 mt-2 mr-2 text-sm cursor-pointer",onClick:()=>t(!e),children:e?"Hide":"Show"})]}),(0,s.jsx)(l.Bc,{className:"text-red-500 text-xs italic",name:"password",component:"div"})]}),(0,s.jsx)(n.Z,{disabled:a,type:"submit",children:"Continue"})]})}}),(0,s.jsxs)("span",{className:"block text-center text-neutral-700 dark:text-neutral-300",children:["New user? "," ",(0,s.jsx)(c(),{className:"text-green-600",href:"/signup",children:"Create an account"})]})]})]})})}},53321:function(e,t,r){"use strict";r.d(t,{EI:function(){return h},HN:function(){return u},Xq:function(){return d},be:function(){return o},dv:function(){return m}});var s=r(54829);let a="https://api.velonna.co/",n=!1,o=s.Z.create({baseURL:a}),c=()=>{try{let e=localStorage.getItem("accessToken");return e||null}catch(e){return console.error("Error fetching access token:",e),null}},l=(e,t)=>{try{e&&localStorage.setItem("accessToken",e),t&&localStorage.setItem("refreshToken",t)}catch(e){console.error("Error storing tokens:",e)}},i=async()=>{try{let e=localStorage.getItem("refreshToken");if(!e)throw Error("No refresh token available");let t=await s.Z.post("".concat(a,"/refresh-token/"),{refresh_token:e}),{access_token:r}=t.data||{};if(r)return await l(r,e),r;throw Error("Failed to refresh access token")}catch(e){throw console.error("Error refreshing token:",e),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),e}};o.interceptors.request.use(async e=>{let t=c();return t&&(e.headers.Authorization="Bearer ".concat(t)),e.headers["Content-Type"]="application/json",e},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,async e=>{let{config:t,response:r}=e;if((null==r?void 0:r.status)===401&&n){n=!1;try{let e=await i();return t.headers.Authorization="Bearer ".concat(e),o(t)}catch(e){throw console.error("Token refresh failed:",e),e}finally{n=!0}}return Promise.reject(e)});let u=async()=>{try{let e=await o.get("/addresses/");return e.data}catch(e){throw console.error("Error fetching user info:",e),e}},d=async(e,t)=>{try{let r={product:e,quantity:String(t)},s=await o.post("/cart/",r);return s}catch(e){throw console.error("Error adding product to cart:",e),e}},m=async()=>{try{let e=await o.get("/cart/details/");return e.data}catch(e){throw console.error("Error fetching cart:",e),e}},h=async e=>{try{let t=await o.delete("cart-item/".concat(e,"/"));if(console.log(t),console.log(t.status),!t||204===t.status)return console.log(t),console.log(t.status),console.log("Item successfully deleted"),{};return t.data}catch(e){throw e.response?console.error("Server responded with error:",e.response.data):e.request?console.error("No response received:",e.request):console.error("Error setting up request:",e.message),e}}},40265:function(e,t,r){"use strict";r.d(t,{H:function(){return u},a:function(){return d}});var s=r(57437),a=r(2265),n=r(54829),o=r(24033),c=r(5925),l=r(53321);let i=(0,a.createContext)(),u=e=>{let{children:t}=e,[r,u]=(0,a.useState)(!1),[d,m]=(0,a.useState)(null),[h,f]=(0,a.useState)(!0),p=(0,o.useRouter)(),g=async e=>{try{let t=await n.Z.post("https://api.velonna.co/login/",{username:e.username,password:e.password},{headers:{accept:"application/json","Content-Type":"application/json"}});if(200===t.status){let{access:r,refresh:s}=t.data;localStorage.setItem("username",e.username),localStorage.setItem("accessToken",r),localStorage.setItem("refreshToken",s),u(!0),c.default.success("Login successful!"),p.refresh()}}catch(e){u(!1),m(null),c.default.error("Login failed. Please check your credentials.")}},x=async()=>{try{let e=localStorage.getItem("username"),t=await l.be.get("/user/".concat(e,"/"));return console.log(t.data),m(t.data),u(!0),t.data}catch(e){throw console.error("Error fetching user info:",e),e}};return(0,a.useEffect)(()=>{let e=async()=>{try{let e=localStorage.getItem("accessToken");if(e){let e=localStorage.getItem("username");e&&await x()}else u(!1),m(null)}catch(e){console.error("Error during user data fetch:",e),u(!1),m(null)}finally{f(!1)}};e()},[]),(0,s.jsx)(i.Provider,{value:{is_auth:r,login:g,user:d,logout:()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("username"),u(!1),m(null),p.push(),c.default.success("Logged out successfully.")},loading:h},children:t})},d=()=>(0,a.useContext)(i)},70716:function(e,t,r){"use strict";let s;r.d(t,{A:function(){return s}}),r(72770)},95374:function(e,t,r){"use strict";r.r(t);var s=r(57437);r(2265);var a=r(56010);r(70716);var n=r(61396),o=r.n(n);t.default=e=>{let{className:t="text-neutral-700 dark:text-neutral-200 disabled:cursor-not-allowed",translate:r="",sizeClass:n="py-3 px-4 sm:py-3.5 sm:px-6",fontSize:c="text-sm sm:text-base font-medium",disabled:l=!1,href:i,children:u,targetBlank:d,type:m,loading:h,onClick:f=()=>{}}=e,p="nc-Button relative h-auto inline-flex items-center justify-center rounded-full transition-colors ".concat(c," ").concat(n," ").concat(r," ").concat(t," ")+(0,a.Z)(!0);return i?(0,s.jsx)(o(),{href:i,className:"".concat(p," "),onClick:f,children:u||"This is Link"}):(0,s.jsxs)("button",{disabled:l||h,className:"".concat(p),onClick:f,type:m,children:[h&&(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),u||"This is Button"]})}},10298:function(e,t,r){"use strict";var s=r(57437),a=r(95374);r(2265),t.Z=e=>{let{className:t="",...r}=e;return(0,s.jsx)(a.default,{className:"ttnc-ButtonPrimary disabled:bg-opacity-50 bg-slate-900 dark:bg-slate-100 hover:bg-slate-800 text-slate-50 dark:text-slate-800 shadow-xl ".concat(t),...r})}},56010:function(e,t,r){"use strict";function s(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?"focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-6000 dark:focus:ring-offset-0":"focus:outline-none"}r.d(t,{Z:function(){return s}})}},function(e){e.O(0,[1176,4829,1920,2971,2472,1744],function(){return e(e.s=12766)}),_N_E=e.O()}]);